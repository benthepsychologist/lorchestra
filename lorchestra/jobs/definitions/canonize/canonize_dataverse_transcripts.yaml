job_id: canonize_dataverse_transcripts
version: '2.0'
steps:
- step_id: canonize
  op: call
  params:
    callable: canonizer
    source_type: dataverse
    config:
      transform_id: session_transcript/dataverse_to_canonical@2-0-0
- step_id: persist
  op: plan.build
  params:
    items: '@run.canonize.items'
    method: bq.upsert
    dataset: canonical
    table: canonical_objects
    key_columns:
    - idem_key
    auto_timestamp_columns:
    - canonicalized_at
    - created_at
- step_id: write
  op: storacle.submit
  params:
    plan: '@run.persist.plan'
