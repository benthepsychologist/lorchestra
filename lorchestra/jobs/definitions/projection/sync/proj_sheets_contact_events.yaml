job_id: proj_sheets_contact_events
version: '2.0'
steps:
- step_id: project
  op: call
  params:
    callable: projectionist
    projection_id: sheets
    config:
      query: SELECT ce.* FROM `${PROJECT}.${DATASET_CANONICAL}.proj_contact_events`
        ce WHERE ce.contact_email IN (SELECT email FROM `${PROJECT}.${DATASET_CANONICAL}.proj_clients`)
      spreadsheet_id: 1Wf8EyuNR-I-ko5bx0M4L7BXousAqkj3vxN8xP1-aAzo
      sheet_name: contact_events
      strategy: replace
      account: acct1
- step_id: persist
  op: plan.build
  params:
    items: '@run.project.items'
    method: wal.append
- step_id: write
  op: storacle.submit
  params:
    plan: '@run.persist.plan'
